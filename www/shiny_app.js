/*! For license information please see shiny_app.js.LICENSE.txt */
!function(){"use strict";!function(){var e=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return!1;var n=document.querySelector("[data-value='Dimmer'].tab-pane");return e.classList.remove("active"),t&&n&&(n.classList.remove("dim"),n.replaceWith(n.cloneNode(!0))),!0};function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){var e,t,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function c(n,a,o,i){var c=a&&a.prototype instanceof s?a:s,l=Object.create(c.prototype);return r(l,"_invoke",function(n,r,a){var o,i,c,s=0,l=a||[],d=!1,f={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,n){return o=t,i=0,c=e,f.n=n,u}};function v(n,r){for(i=n,c=r,t=0;!d&&s&&!a&&t<l.length;t++){var a,o=l[t],v=f.p,p=o[2];n>3?(a=p===r)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=v&&((a=n<2&&v<o[1])?(i=0,f.v=r,f.n=o[1]):v<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,f.n=p,i=0))}if(a||n>1)return u;throw d=!0,r}return function(a,l,p){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&v(l,p),i=l,c=p;(t=i<2?e:c)||!d;){o||(i?i<3?(i>1&&(f.n=-1),v(i,c)):f.n=c:f.v=c);try{if(s=2,o){if(i||(a="next"),t=o[a]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==u)break}catch(t){o=e,i=1,c=t}finally{s=1}}return{value:t,done:d}}}(n,o,i),!0),l}var u={};function s(){}function l(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(r(t={},o,function(){return this}),t),v=d.prototype=s.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,i,"GeneratorFunction")),e.prototype=Object.create(v),e}return l.prototype=d,r(v,"constructor",d),r(d,"constructor",l),l.displayName="GeneratorFunction",r(d,i,"GeneratorFunction"),r(v),r(v,i,"Generator"),r(v,o,function(){return this}),r(v,"toString",function(){return"[object Generator]"}),(n=function(){return{w:c,m:p}})()}function r(e,t,n,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}r=function(e,t,n,a){function i(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},r(e,t,n,a)}function a(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function c(e){a(i,r,o,c,u,"next",e)}function u(e){a(i,r,o,c,u,"throw",e)}c(void 0)})}}var i=function(){return document.getElementById("search-input")},c=function(){var e=o(n().m(function e(t){var r,a,o,i,c,u;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=(t||"").trim()){e.n=1;break}return e.a(2,[]);case 1:for(i in a=new URL("https://nominatim.openstreetmap.org/search"),o={format:"json",countrycodes:"au",viewbox:"144.93366,-37.79264,144.97670,-37.82391",bounded:"1",q:r})a.searchParams.append(i,o[i]);return p(),e.p=2,e.n=3,fetch(a);case 3:if(200===(c=e.v).status){e.n=4;break}throw new Error("Bad Server Response (".concat(c.status,")"));case 4:return e.n=5,c.json();case 5:return e.a(2,e.v);case 6:return e.p=6,u=e.v,console.error("Error querying OpenStreetMap:",u),e.a(2,[]);case 7:return e.p=7,m(),e.f(7);case 8:return e.a(2)}},e,null,[[2,6,7,8]])}));return function(t){return e.apply(this,arguments)}}(),u=function(e){var n,r=document.querySelector("[data-value='SearchResults'].tab-pane");if(r){r.innerHTML="";var a=(Array.isArray(e)?e:[]).map(function(e){var t=document.createElement("div");t.classList.add("result-wrapper");var n=l(e);t.addEventListener("click",function(){var t=i();if(t){var r=e||{},a=r.lat,o=r.lon;if(null!=a&&null!=o){t.dispatchEvent(new CustomEvent("set:loc",{detail:e}));var c=document.querySelector("[data-value='SearchResults'].tab-pane");c&&c.dispatchEvent(new CustomEvent("close:panel",{detail:e})),t.value=n[0]||"Unknown name",f(),g()}else s("Selected result is missing location data.",!0)}});var r=document.createElement("div");r.classList.add("result-name"),r.innerHTML=n[0]||"Unknown name";var a=document.createElement("div");return a.classList.add("result-loc"),a.innerHTML=n[1]&&n.slice(1).join(" ")||"Unknown location",t.appendChild(r),t.appendChild(a),t});a.length<1&&s("No results found, please try again."),r.append.apply(r,function(e){if(Array.isArray(e))return t(e)}(n=a)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d()}},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=document.querySelector("[data-value='SearchResults'].tab-pane");if(n){n.innerHTML="";var r=document.createElement("div");r.classList.add("result-none"),r.innerHTML=e,n.append(r),t&&d()}},l=function(e){return e.display_name&&e.display_name.split(",")||[]},d=function(){var e=document.querySelector("[data-value='SearchResults'].tab-pane"),t=i();if(e&&t){var n=t.closest(".wrapper");if(n){var r=n.getBoundingClientRect(),a=r.bottom,o=r.width;e.style.top="".concat(a,"px"),e.style.width="".concat(o,"px"),e.classList.add("active")}}},f=function(){var e=document.querySelector("[data-value='SearchResults'].tab-pane");e&&e.classList.remove("active")},v=function(){var e=o(n().m(function e(){var t,r,a,o;return n().w(function(e){for(;;)switch(e.n){case 0:if(t=i()){e.n=1;break}return e.a(2);case 1:if(r=t.value||"",a=r.trim()){e.n=2;break}return s("Please enter a destination.",!0),e.a(2);case 2:return e.n=3,c(a);case 3:o=e.v,u(o);case 4:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),p=function(){var e=document.querySelector("[data-value='Search'].tab-pane");e&&e.classList.add("busy");var t=i();t&&t.dispatchEvent(new CustomEvent("search:busy"))},m=function(){var e=document.querySelector("[data-value='Search'].tab-pane");e&&e.classList.remove("busy");var t=i();t&&t.dispatchEvent(new CustomEvent("search:done"))},y=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t=e.coords,n=t.latitude,r=t.longitude;document.getElementById("search-input").dispatchEvent(new CustomEvent("set:loc",{detail:{lat:n,lon:r}})),s("Current GPS location set.",!0),h()},function(e){var t="Unable to access current location.";if(e)switch(e.code){case e.PERMISSION_DENIED:t="Location permission was denied.";break;case e.POSITION_UNAVAILABLE:t="Location information is unavailable.";break;case e.TIMEOUT:t="Location request timed out. Please try again.";break;default:t=e.message||t}s(t,!0)})},h=function(){document.getElementById("button-gps").classList.add("active")},g=function(){document.getElementById("button-gps").classList.remove("active")},b=function(){var t=document.querySelector("[data-value='Filters'].tab-pane");t&&(t.classList.contains("active")?e(t):function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t)return!1;var r=document.querySelector("[data-value='Dimmer'].tab-pane");t.classList.add("active"),n&&r&&(r.classList.add("dim"),r.addEventListener("click",function(){return e(t)},{once:!0}))}(t))};function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var S=function(){return document.querySelector("[data-value='Intro'].tab-pane")},w=function(e,t){if(e){var n=parseInt(e.dataset.pageCount||"0",10)||e.getElementsByClassName("page").length||0;if(!(n<1)){for(var r=Math.min(Math.max(t,1),n),a=1;a<=n;a+=1)e.classList.remove("page-".concat(a));e.classList.add("page-".concat(r)),e.dataset.currentPage=String(r),e.dataset.pageCount=String(n)}}},L=function(e){var t=e.currentTarget||e.target,n=t&&t.getAttribute("direction"),r=S();if(n&&r){var a=parseInt(r.dataset.currentPage||"1",10)||1,o=parseInt(r.dataset.pageCount||"0",10)||r.getElementsByClassName("page").length||0;"left"===n?w(r,a-1):"right"===n&&(a<o?w(r,a+1):r.classList.remove("active"))}};!function(e){window.onload=function(){navigator.userAgent.includes("QtWebEngine")&&window.alert("For best effect, please use an external browser."),window.search=c},e(document).on("shiny:sessioninitialized",function(e){var t;(t=S())&&(t.classList.add("active"),w(t,1)),function(){var e=document.getElementById("filters-show-hide");e&&e.addEventListener("click",b);var t=document.getElementById("button-search");t&&t.addEventListener("click",v);var n=document.getElementById("button-gps");n&&n.addEventListener("click",y);var r=document.getElementById("search-input");r&&r.addEventListener("keydown",function(e){switch(e.key){case"Enter":e.preventDefault(),e.stopPropagation(),v();break;case"Escape":e.preventDefault(),e.stopPropagation(),e.target.blur(),f()}}),document.addEventListener("click",function(e){var t=document.querySelector("[data-value='SearchResults'].tab-pane"),n=document.querySelector(".search-bar .wrapper");t&&n&&!t.contains(e.target)&&!n.contains(e.target)&&f()})}(),function(){var e=S();if(e){var t=e.getElementsByClassName("page").length||0;e.dataset.pageCount=String(t),e.dataset.currentPage="1",w(e,1);var n=document.getElementById("intro-left"),r=document.getElementById("intro-right");n&&n.addEventListener("click",L),r&&r.addEventListener("click",L)}}(),function(){document.querySelector("[data-value='SearchResults'].tab-pane");var e=i();e&&(e.addEventListener("search:busy",function(){}),e.addEventListener("search:done",function(){}),e.addEventListener("set:loc",function(e){var t=(e||{}).detail;t&&null!=t.lat&&null!=t.lon?"undefined"!=typeof Shiny&&Shiny.setInputValue&&Shiny.setInputValue("js_set_loc",t):s("Selected result is missing location data.",!0)}))}(),function(){var e=document.querySelector("#filter_radius");if(e){var t=e.closest(".shiny-input-container");if(t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return E(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}(t.getElementsByClassName("irs-grid-text"));try{for(r.s();!(n=r.n()).done;){var a=n.value;try{var o=parseFloat(a.innerHTML);o>0&&o<=100&&(o<1&&(a.innerHTML="".concat(parseInt(1e3*o)," m")),o>=1&&(a.innerHTML="".concat(parseInt(o)," km")))}catch(e){continue}}}catch(e){r.e(e)}finally{r.f()}}}}()})}($)}()}();
//# sourceMappingURL=shiny_app.js.map